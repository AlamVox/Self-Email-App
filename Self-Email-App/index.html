<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Login</title>
    <style>
        body { font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; background-color: #f4f4f9; margin: 0; }
        .login-box { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); width: 300px; text-align: center; }
        input { width: 90%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 4px; }
        button { width: 100%; padding: 10px; background: #007BFF; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background: #0056b3; }
        #status { margin-top: 15px; font-weight: bold; }
    </style>
</head>
<body>

<div class="login-box">
    <h2>Secure Login</h2>
    <input type="text" id="username" placeholder="User ID" required>
    <input type="password" id="password" placeholder="Password" required>
    <button onclick="loginUser()" id="loginBtn">Login</button>
    <p id="status"></p>
</div>

<script>
    function loginUser() {
        const user = document.getElementById("username").value;
        const pass = document.getElementById("password").value;
        const statusText = document.getElementById("status");
        const loginBtn = document.getElementById("loginBtn");
        
        // REPLACE THIS WITH YOUR DEPLOYED GOOGLE APPS SCRIPT URL
        const scriptURL = "https://script.google.com/macros/s/AKfycbyiOy1l4yGnrNprcToe1rBQwRhOl_QI-36fJxQemQUVbjGVWC0XtzP91WOlgCFcLfO4/exec";

        if(user === "" || pass === "") {
            statusText.innerText = "Please enter both ID and Password.";
            statusText.style.color = "red";
            return;
        }

        statusText.innerText = "Authenticating...";
        statusText.style.color = "blue";
        loginBtn.disabled = true;

        fetch(scriptURL, {
            method: 'POST',
            body: JSON.stringify({ username: user, password: pass })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                statusText.innerText = "Access Granted! Redirecting...";
                statusText.style.color = "green";
                
                // Set the session token!
                sessionStorage.setItem("isLoggedIn", "true");
                
                // Redirect to the protected dashboard
                setTimeout(() => {
                    window.location.href = "dashboard.html"; 
                }, 1000);
            } else {
                statusText.innerText = "Invalid User ID or Password.";
                statusText.style.color = "red";
                loginBtn.disabled = false;
            }
        })
        .catch(error => {
            statusText.innerText = "System error. Try again.";
            statusText.style.color = "red";
            loginBtn.disabled = false;
            console.error('Error:', error);
        });
    }
</script>

</body>
</html>
